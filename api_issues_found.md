# API å‹•ä½œå•é¡Œãƒ¬ãƒãƒ¼ãƒˆ

## ç™ºè¦‹æ—¥æ™‚

2025 å¹´ 7 æœˆ 21 æ—¥ 09:30

## é€²æ—ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼ˆ2025 å¹´ 8 æœˆ 10 æ—¥ï¼‰

æœ€æ–°ã®ä¿®æ­£çŠ¶æ³ã¨ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²ã—ã¾ã™ã€‚æ¬¡ã®æ”¹å–„ã«é€²ã‚€å‰ã«æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚

- é«˜å„ªå…ˆåº¦ 3 ä»¶ï¼ˆæœ¬ç•ªå½±éŸ¿å¤§ï¼‰: å¯¾å¿œæ¸ˆã¿ï¼ˆãƒ†ã‚¹ãƒˆç¢ºèªæ¸ˆã¿ï¼‰

  - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ API ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: ä¾‹å¤–æ•æ‰ã¨é©åˆ‡ãª HTTP ã‚¨ãƒ©ãƒ¼è¿”å´ã‚’ routes ã«å®Ÿè£…ã€‚ãƒ†ã‚¹ãƒˆå†å®Ÿè¡Œã§å›å¸°ãªã—ã€‚
    - æ¤œè¨¼ãƒ­ã‚°: `post-metadata-20250810-060348.log`
  - ãƒ­ã‚° API ã® Pydantic å‹å®šç¾©: `log_id` ã‚’ str ã¨ã—ã¦è¿”ã™ã‚ˆã†æ•´åˆåŒ–ã€‚ãƒ†ã‚¹ãƒˆå†å®Ÿè¡Œã§å›å¸°ãªã—ã€‚
    - æ¤œè¨¼ãƒ­ã‚°: `post-logs-20250810-060348.log`
  - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ API ã® Content-Type: charset é‡è¤‡ã‚’è§£æ¶ˆã— `text/csv; charset=utf-8` ã«çµ±ä¸€ã€‚ãƒ†ã‚¹ãƒˆå†å®Ÿè¡Œã§å›å¸°ãªã—ã€‚
    - æ¤œè¨¼ãƒ­ã‚°: `post-export-20250810-060348.log`

- æ¬¡ã«å¯¾å¿œã™ã‚‹é …ç›®ï¼ˆä¸­å„ªå…ˆåº¦ï¼‰
  - èªè¨¼ API ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã®çµ±ä¸€ï¼ˆ/login ã« success ã‚’è¿½åŠ ã—ã¦æš«å®šçµ±ä¸€ã€æœ€çµ‚æ–¹é‡æ¤œè¨ï¼‰

è¿½åŠ å¯¾å¿œï¼ˆ2025-08-10ï¼‰:

- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¾‹å¤–å‡¦ç†ã®æ”¹å–„ï¼ˆCSV ç”Ÿæˆï¼‰: å¯¾å¿œæ¸ˆã¿

  - å¯¾è±¡: `/sql/download/csv`
  - å¤‰æ›´: ãƒ¬ã‚¹ãƒãƒ³ã‚¹é–‹å§‹å‰ã« SQL å®Ÿè¡Œã¨ã‚«ãƒ©ãƒ å–å¾—ã‚’å®Ÿæ–½ã—ã€ä¾‹å¤–ã‚’äº‹å‰ã«æ¤œå‡ºã€‚ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿å†…ã¯ I/O ã®ã¿ã«é™å®šã€‚
  - åŠ¹æœ: `RuntimeError: Caught handled exception, but response already started.` ã®å†ç™ºã‚’æŠ‘æ­¢
  - ãƒ†ã‚¹ãƒˆ: `app/tests/test_export_api.py` â†’ 8 passed, 3 skippedï¼ˆãƒ­ã‚°ã¯ç¢ºèªå¾Œã«å‰Šé™¤ï¼‰

  - ãƒ­ã‚° API ã®æœªå®Ÿè£…ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ˜ç¢ºåŒ–ï¼ˆã‚¹ã‚¿ãƒ–ï¼‰: å®Ÿè£…æ¸ˆã¿
    - `/logs/analytics` ã¨ `/logs/export` ã« 501 Not Implemented ã‚’æ˜ç¤ºè¿”å´
    - ç›®çš„: 404 ã‹ã‚‰ã®çŠ¶æ…‹æ”¹å–„ã¨ä»•æ§˜æœªæ±ºé ˜åŸŸã®æ˜ç¢ºåŒ–ã€‚å°†æ¥å®Ÿè£…æ™‚ã®ç§»è¡Œå½±éŸ¿ã‚’æœ€å°åŒ–
    - ãƒ†ã‚¹ãƒˆ: `app/tests/test_logs_api.py` â†’ 7 passed, 4 skippedï¼ˆãƒ­ã‚°ã¯ç¢ºèªå¾Œã«å‰Šé™¤ï¼‰

- èªè¨¼ API ã®åˆ·æ–°ï¼ˆ/refresh å®Ÿè£…ï¼‰: å¯¾å¿œæ¸ˆã¿

  - å¯¾è±¡: `POST /refresh`
  - ä»•æ§˜: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã® current_user ã‚’å‰æã«ã€UserService.authenticate_user ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆSQLiteï¼‰ã‹ã‚‰æœ€æ–°ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ã—ã€`request.session["user"]` ã‚’æ›´æ–°ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ `/login` ã¨åŒä¸€ã‚¹ã‚­ãƒ¼ãƒï¼ˆ`{ success, message, user }`ï¼‰ã€‚
  - ä¾‹å¤–: ãƒ¦ãƒ¼ã‚¶ãƒ¼æœªæ¤œå‡ºã¯ 404ã€ãã®ä»–ã¯ 500 ã‚’è¿”ã™ã€‚
  - ãƒ†ã‚¹ãƒˆ: è¿½åŠ ã—ãŸæœ€å°ãƒ†ã‚¹ãƒˆ `app/tests/test_refresh_api_minimal.py` â†’ 2 passedï¼ˆæœªèªè¨¼ 401 ã‚’å«ã‚€ï¼‰ã€‚
  - å›å¸°ç¢ºèª: `app/tests/test_auth_api.py` â†’ 8 passed, 5 skippedï¼ˆå¤‰æ›´ãªã—ï¼‰ã€‚
  - ãƒ­ã‚°: å®Ÿè¡Œãƒ­ã‚°ã®å…ˆé ­/æœ«å°¾ã‚’ç¢ºèªã€‚`app.log` ã¯ãƒ­ãƒƒã‚¯ã®ãŸã‚å‰Šé™¤ã§ã¯ãªã Clear-Content ã§ã‚¯ãƒªã‚¢ã€‚

- èªè¨¼ API ã®è£œå¼·ï¼ˆ/user/info, /users/me ã®æœ€å°ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼‰: å¯¾å¿œæ¸ˆã¿
  - è¿½åŠ ãƒ†ã‚¹ãƒˆ:
    - `app/tests/test_user_info_api_minimal.py` â†’ 2 passedï¼ˆèªè¨¼ã‚ã‚Š/æœªèªè¨¼ï¼‰
    - `app/tests/test_users_me_api_minimal.py` â†’ 2 passedï¼ˆèªè¨¼ã‚ã‚Š/æœªèªè¨¼ï¼‰
  - ç›®çš„: ã‚»ãƒƒã‚·ãƒ§ãƒ³ DI ä¸Šæ›¸ãã«ã‚ˆã‚‹ç°¡æ˜“æ¤œè¨¼ã§ã€FastAPI TestClient åˆ¶ç´„ï¼ˆsession_transaction éå¯¾å¿œï¼‰ã‚’å›é¿
  - ãƒ­ã‚°: å®Ÿè¡Œå¾Œã« app.log ã‚’ç¢ºèªã®ã†ãˆ Clear-Content ã§ã‚¯ãƒªã‚¢

å‚™è€ƒ: ãƒ­ã‚°ã¯ç¢ºèªå¾Œã«å‰Šé™¤ã™ã‚‹é‹ç”¨ã¸ç§»è¡Œï¼ˆè©³ç´°ã¯ `Rule_of_coding.md` ã®ãƒ†ã‚¹ãƒˆé‹ç”¨ãƒ«ãƒ¼ãƒ«å‚ç…§ï¼‰ã€‚

â€” ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€ã®é©ç”¨ç¯„å›²æ‹¡å¤§ï¼ˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ API/ãƒ­ã‚° APIï¼‰: å¯¾å¿œæ¸ˆã¿

    - è¿½åŠ ãƒ†ã‚¹ãƒˆ:
      - `app/tests/test_error_response_metadata_minimal.py` â†’ 2 passed
      - æ—¢å­˜ã® `app/tests/test_error_response_minimal.py` ã¨ä½µã›ã¦ 4 passed ã‚’ç¢ºèª
    - ç›®çš„: `timestamp` ã‚’å«ã‚€çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ç¶­æŒæ¤œè¨¼ï¼ˆHTTPException/ä¸€èˆ¬ä¾‹å¤–/ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
    - ãƒ­ã‚°: å®Ÿè¡Œå¾Œã« app.log ã‚’ç¢ºèªã—ã€Clear-Content ã§ã‚¯ãƒªã‚¢

â€” ä»˜éšä¿®æ­£: ODBC ãƒ­ã‚¬ãƒ¼ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¼•æ•°ã‚¨ãƒ©ãƒ¼ä¿®æ­£

    - ç¾è±¡: `Logger.info() takes 2 positional arguments but 3 were given`
    - åŸå› : `logging` æ¨™æº–ã®`%s`ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¼•æ•°ã‚¹ã‚¿ã‚¤ãƒ«ãŒã‚«ã‚¹ã‚¿ãƒ  Logger ã®ã‚·ã‚°ãƒãƒãƒ£ã¨ä¸æ•´åˆ
    - ä¿®æ­£: `app/services/connection_manager_odbc.py` ã® warning/info å‘¼ã³å‡ºã—ã‚’ fæ–‡å­—åˆ—ã«å¤‰æ›´
    - æ¤œè¨¼: æœ€å°ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã® `app.log` ã«ã‚¨ãƒ©ãƒ¼å†ç™ºãªã—

- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€ã®é©ç”¨ç¯„å›²æ‹¡å¤§ï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/CSV ç³»ï¼‰: å¯¾å¿œæ¸ˆã¿

  - è¿½åŠ ãƒ†ã‚¹ãƒˆ: `app/tests/test_error_response_export_minimal.py` â†’ 5 passed
    - /sql/download/csv: ç©º SQL(400), SQL å®Ÿè¡Œä¾‹å¤–(500), ä»¶æ•°è¶…é(400)
    - /sql/cache/download/csv: session_id æ¬ å¦‚(422), ãƒ‡ãƒ¼ã‚¿ãªã—(404)
  - å¤‰æ›´: /sql/cache/download/csv ã§ç™ºç”Ÿã™ã‚‹ HTTPException(404) ã‚’ 500 ã«ãƒ©ãƒƒãƒ—ã›ãšã«ä¼æ’­
  - ãƒ­ã‚°: å®Ÿè¡Œå¾Œã« app.log ã‚’ç¢ºèªã—ã€Clear-Content ã§ã‚¯ãƒªã‚¢

- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€ã®é©ç”¨ç¯„å›²æ‹¡å¤§ï¼ˆèªè¨¼/èªå¯ ç³»ï¼‰: å¯¾å¿œæ¸ˆã¿

  - è¿½åŠ ãƒ†ã‚¹ãƒˆ: `app/tests/test_error_response_authz_minimal.py` â†’ 3 passed
    - /admin/system/refresh: æœªèªè¨¼ 401ã€æ¨©é™ä¸è¶³ 403
    - /users/templates: æœªèªè¨¼ 401
  - ãƒãƒªã‚·ãƒ¼: 401/403 ã¯ HTTPException ã‚’ãã®ã¾ã¾çµ±ä¸€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¸ä¼æ’­
  - ãƒ­ã‚°: å®Ÿè¡Œå¾Œã« app.log ã‚’ç¢ºèªã—ã€Clear-Content ã§ã‚¯ãƒªã‚¢

- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€ã®é©ç”¨ç¯„å›²æ‹¡å¤§ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ/ãƒ‘ãƒ¼ãƒ„ ç³»ï¼‰: å¯¾å¿œæ¸ˆã¿ï¼ˆ2025-08-10ï¼‰

  - è¿½åŠ ãƒ†ã‚¹ãƒˆ: `app/tests/test_error_response_templates_parts_minimal.py` â†’ 5 passed
    - /admin/templates: ã‚µãƒ¼ãƒ“ã‚¹ä¾‹å¤–æ™‚ 500ï¼ˆçµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
    - /users/templates: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¬ å¦‚æ™‚ 422ï¼ˆçµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
    - /users/templates/{template_id}: ã‚µãƒ¼ãƒ“ã‚¹ä¾‹å¤–(ValueError)æ™‚ 500ï¼ˆçµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
    - /admin/parts: ã‚µãƒ¼ãƒ“ã‚¹ä¾‹å¤–æ™‚ 500ï¼ˆçµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
    - /users/parts: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¬ å¦‚æ™‚ 422ï¼ˆçµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
  - å‚™è€ƒ: FastAPI TestClient ã®ä¾‹å¤–å†ã‚¹ãƒ­ãƒ¼ã«ã‚ˆã‚Š 500 æ¤œè¨¼ãŒå¦¨ã’ã‚‰ã‚Œã¦ã„ãŸãŸã‚ã€ãƒ†ã‚¹ãƒˆç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ `raise_server_exceptions=False` ã«è¨­å®šï¼ˆ`conftest.py` ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ï¼‰ã€‚
  - ãƒ­ã‚°: å®Ÿè¡Œå¾Œã« app.log ã‚’ç¢ºèªã—ã€Clear-Content ã§ã‚¯ãƒªã‚¢

â€” è¡¨ç¤ºè¨­å®š APIï¼ˆ/admin/visibility-settings, /visibility-settingsï¼‰: å¯¾å¿œæ¸ˆã¿ï¼ˆ2025-08-10ï¼‰

- å¤‰æ›´ç‚¹:
  - GET /admin/visibility-settings ã¨ GET /visibility-settings ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ `{ "settings": ... }` ã¸çµ±ä¸€
  - POST /admin/visibility-settings ã®å…¥åŠ›ã‚’æ‹¡å¼µã—ã€`{"settings": {object_name: is_visible}}` å½¢å¼ï¼ˆdictï¼‰ã¨ã€æ—¢å­˜ã® `{"settings": [VisibilitySetting, ...]}` å½¢å¼ï¼ˆlistï¼‰ã®ä¸¡æ–¹ã‚’å—å®¹
  - ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…å·®åˆ†ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€`get_all_visibility_settings|get_all_settings` ã¨ `save_visibility_settings|save_settings` ã®ä¸¡ãƒ¡ã‚½ãƒƒãƒ‰åã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯¾å¿œ
- è¿½åŠ /æ›´æ–°: `app/api/models.py` ã« `SaveVisibilitySettingsDictRequest` ã‚’è¿½åŠ 
- ãƒ†ã‚¹ãƒˆ: `TestVisibilitySettingsAPI::test_get_visibility_settings_success`, `::test_save_visibility_settings_success` â†’ 2 passed
- ãƒ­ã‚°: ç•°å¸¸å‡ºåŠ›ãªã—ï¼ˆ`app/tests/app.log` ã®ã¿ä½¿ç”¨ï¼‰ã€‚

â€” äº’æ› API ã®è¿½åŠ ã¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ”¹å–„ï¼ˆ2025-08-10ï¼‰

- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ API ã®äº’æ›ãƒ©ãƒƒãƒ‘ãƒ¼è¿½åŠ :
  - GET `/metadata/tables?schema_name=...` â†’ `{ "tables": [...] }`
  - GET `/metadata/columns?schema_name=...&table_name=...` â†’ `{ "columns": [...] }`
  - GET `/metadata/schemas` ã¯ `{ "schemas": [...] }` ã§è¿”å´
  - ç®¡ç†è€…ç”¨ GET `/admin/metadata/all-raw` ã¯ `get_all_metadata_raw` ãŒã‚ã‚Œã°å„ªå…ˆã€ç„¡ã„å ´åˆã¯ `get_all_metadata`
- SQL è£œå®Œ API æ”¹å–„:
  - ç©º SQL æ™‚ã¯ 400 + `detail: "SQLã‚¯ã‚¨ãƒªãŒç©ºã§ã™"` ã‚’è¿”å´
  - ä¾‹å¤–æ™‚ã¯ 500 + `detail` ã«å…ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ API æ”¹å–„:
  - ã‚µãƒ¼ãƒ“ã‚¹ä¾‹å¤–æ™‚ã« 500 ã‚’è¿”å´
- ã‚¯ãƒªãƒ³ãƒŠãƒƒãƒ— API è¿½åŠ :
  - POST `/cleanup/cache` â†’ `{ success: true, message: "ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸ" }`
- ãƒ†ã‚¹ãƒˆ: å¯¾å¿œç¯„å›²ã®æœ€å°ãƒ†ã‚¹ãƒˆ â†’ 9 passedï¼ˆè¡¨ç¤ºè¨­å®š 2 ä»¶ã€äº’æ›/è£œå®Œ/æ€§èƒ½/ã‚¯ãƒªãƒ³ãƒŠãƒƒãƒ—é–¢é€£ï¼‰

- HybridSQLService ã®ãƒ†ã‚¹ãƒˆäº’æ›ä¿®æ­£ï¼ˆ2025-08-10ï¼‰: å¯¾å¿œæ¸ˆã¿

  - å¤‰æ›´ç‚¹:
    - execute_sql_with_cache ã«ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼ˆcache_service.cache_results ãŒå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
    - ã‚»ãƒƒã‚·ãƒ§ãƒ³ ID ç”Ÿæˆã§ session_service.create_session ã‚’å„ªå…ˆï¼ˆæ—§ãƒ†ã‚¹ãƒˆäº’æ›ï¼‰
    - ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ã¯ fetchall + cache_results ã‚’ä½¿ç”¨ã—ã€COUNT å–å¾—å¤±æ•—æ™‚ã¯ processed_rows ã‚’ total_count ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    - get_cached_data ã¯æ¬ æã‚­ãƒ¼ï¼ˆpage/page_size/total_pagesï¼‰ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§è£œå®Œ
    - \_get_total_count ã¯å¤šæ§˜ãª Mock æˆ»ã‚Šå€¤ã«å¯¾å¿œã—ã€ä¾‹å¤–æ™‚ã¯ 0 ã‚’è¿”ã™ï¼ˆLogger.debug ã®å¼•æ•°ä¸æ•´åˆã‚‚ä¿®æ­£ï¼‰
  - ãƒ†ã‚¹ãƒˆçµæœ:
    - app/tests/test_services.py::TestHybridSQLService â†’ 5 passedï¼ˆä»–ã¯ deselectedï¼‰
  - å½±éŸ¿ç¯„å›²:
    - æ—¢å­˜ API ã®æŒ™å‹•ã¯ç¶­æŒï¼ˆé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã¯å¾“æ¥ã©ãŠã‚Šã®ã‚«ãƒ¼ã‚½ãƒ«é€æ¬¡å–å¾—ï¼‰ã€‚
    - æ—§ãƒ†ã‚¹ãƒˆãŒæœŸå¾…ã™ã‚‹ãƒ¬ã‚¬ã‚·ãƒ¼çµŒè·¯ã§ã‚‚æˆåŠŸã™ã‚‹ã‚ˆã†äº’æ›ã‚’ç¢ºä¿ã€‚

- CORS ã¨ãƒãƒ¼ãƒˆã® .env åŒ–ï¼ˆ2025-08-10ï¼‰: å¯¾å¿œæ¸ˆã¿

  - å¤‰æ›´ç‚¹:
  - ç’°å¢ƒå¤‰æ•° `CORS_ORIGINS` ã‚’å°å…¥ã—ã€`.env` ã‹ã‚‰ CORS è¨±å¯ã‚ªãƒªã‚¸ãƒ³ã‚’è¨­å®šå¯èƒ½ã«ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®ã¿å¯¾å¿œï¼‰
    - ãƒãƒ¼ãƒˆè¨­å®šã¯ `APP_PORT` ã«ä¸€æœ¬åŒ–ï¼ˆ`PORT_NO` äº’æ›ä¸Šæ›¸ãã¯å»ƒæ­¢ï¼‰
    - `app/main.py` ã§ `settings.cors_origins` ã‚’ä½¿ç”¨ã—ã¦ CORS ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’æ§‹æˆ
  - æ¤œè¨¼:
    - æœ€å°èµ·å‹•ãƒ†ã‚¹ãƒˆã§è¨±å¯ã‚ªãƒªã‚¸ãƒ³ãŒåæ˜ ã•ã‚Œã‚‹ã“ã¨ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã§ç¢ºèªï¼ˆé–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼‰
    - 127.0.0.1 / localhost ä¸¡æ–¹ã®ã‚ªãƒªã‚¸ãƒ³ã§ Cookie ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç¶­æŒã•ã‚Œã‚‹ã“ã¨ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªäºˆå®š
  - å‚™è€ƒ:
    - `env.example.simplified` ã« `CORS_ORIGINS` ã‚’è¿½è¨˜ï¼ˆ`PORT_NO` è¨˜è¼‰ã¯å‰Šé™¤ï¼‰

## èªè¨¼ API (/login) ã®å•é¡Œ

### å•é¡Œ 1: ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã®ä¸ä¸€è‡´

**æœŸå¾…å€¤ï¼ˆãƒ†ã‚¹ãƒˆï¼‰**:

```json
{
  "success": true,
  "user_id": "test_user",
  "user_name": "Test User"
}
```

**å®Ÿéš›ã® API å®Ÿè£…**:

```json
{
  "message": "ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ",
  "user": {
    "user_id": "test_user",
    "user_name": "Test User"
  }
}
```

**å¯¾å¿œï¼ˆ2025-08-10ï¼‰**:

- /login ã®æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« `success: true` ã‚’è¿½åŠ ã—ã€æš«å®šçµ±ä¸€ã€‚
- /logout ã®æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã‚‚ `success: true` ã‚’è¿½åŠ ã—ã€çµ±ä¸€ã€‚
- /user/info ã‚’å®Ÿè£…ï¼ˆ`GET /user/info` â†’ èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¿”å´ã€`response_model=UserInfo`ï¼‰ã€‚
- /refresh ã¯ä»•æ§˜æœªæ±ºã®ãŸã‚ `501 Not Implemented` ã‚’æ˜ç¤ºè¿”å´ã™ã‚‹ã‚¹ã‚¿ãƒ–ã‚’è¿½åŠ ã€‚
  **å½±éŸ¿**: ãƒ†ã‚¹ãƒˆãŒå®Ÿéš›ã® API ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã¨ä¸€è‡´ã—ã¦ã„ãªã„å•é¡Œã¯è§£æ¶ˆï¼ˆ`app/tests/test_auth_api.py` â†’ 8 passed, 5 skipped ã‚’ç¶­æŒï¼‰ã€‚

### å•é¡Œ 2: ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…ã¨ API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è©³ç´°

**UserService.authenticate_user**: `Optional[Dict[str, Any]]` ã‚’è¿”ã™

- æˆåŠŸæ™‚: `{"user_id": "test_user", "user_name": "Test User", "role": "USER"}`
- å¤±æ•—æ™‚: `None`

**API å®Ÿè£…**:

```python
if user:
    request.session["user"] = user
    return {"message": "ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ", "user": user}
else:
    raise HTTPException(status_code=401, detail="ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãŒç„¡åŠ¹ã§ã™")
```

**å•é¡Œ**: ãƒ†ã‚¹ãƒˆã¯ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ãŒã€å®Ÿéš›ã® API ã¯ç•°ãªã‚‹æ§‹é€ ã‚’è¿”ã™

### å•é¡Œ 3: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®è¤‡é›‘æ€§

**API å®Ÿè£…**: `request.session["user"] = user` ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜
**ãƒ†ã‚¹ãƒˆ**: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã®ãƒ¢ãƒƒã‚¯åŒ–ãŒä¸å®Œå…¨

### å•é¡Œ 4: ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ API ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¸æ•´åˆ

**ç™ºè¦‹ç®‡æ‰€**: `/admin/login`

**ãƒ†ã‚¹ãƒˆã§é€ä¿¡**:

```json
{ "user_id": "admin_user" }
```

**API å®Ÿè£…ã§è¦æ±‚**:

```json
{ "user_id": "admin_user", "password": "required_field" }
```

**ã‚¨ãƒ©ãƒ¼**: `422 Unprocessable Entity` - Field required: password
**å½±éŸ¿**: ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ãŒå…¨ã¦å¤±æ•—

### å•é¡Œ 5: æœªå®Ÿè£…ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**ç™ºè¦‹ç®‡æ‰€**: `/refresh`, `/user/info`

**ç¾çŠ¶å¯¾å¿œï¼ˆ2025-08-10ï¼‰**:

- 501 Not Implemented ã‚’æ˜ç¤ºè¿”å´ã™ã‚‹ã‚¹ã‚¿ãƒ–ã‚’è¿½åŠ ï¼ˆ/refresh, /user/infoï¼‰ã€‚
- ç›®çš„: 404ï¼ˆæœªå®šç¾©ï¼‰ã‹ã‚‰ 501ï¼ˆä»•æ§˜æœªæ±ºãƒ»æœªå®Ÿè£…ï¼‰ã«å¤‰æ›´ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…ã‚’å®‰å®šåŒ–ã€‚

### å•é¡Œ 6: TestClient ã‚»ãƒƒã‚·ãƒ§ãƒ³å‡¦ç†å•é¡Œ

**ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼**: `'TestClient' object has no attribute 'session_transaction'`
**å•é¡Œ**: Flask ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å‡¦ç†æ–¹æ³•ãŒ FastAPI ã® TestClient ã§ä½¿ç”¨ã§ããªã„

## ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. ãƒ†ã‚¹ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æœŸå¾…å€¤ã‚’ API å®Ÿè£…ã«åˆã‚ã›ã‚‹
2. ã‚µãƒ¼ãƒ“ã‚¹ãƒ¢ãƒƒã‚¯ã®æˆ»ã‚Šå€¤ã‚’å®Ÿéš›ã®å‹ã«åˆã‚ã›ã‚‹
3. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®ãƒ¢ãƒƒã‚¯åŒ–ã‚’æ”¹å–„

## ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ API (/logout) ã®å•é¡Œ

### å•é¡Œ 1: ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¾å­˜å‡¦ç†

**API å®Ÿè£…**:

```python
@router.post("/logout")
async def logout(request: Request):
    user = request.session.get("user")
    request.session.clear()
    return {"message": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ"}
```

**å•é¡Œ**:

- ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…å®¹ã«ä¾å­˜ã™ã‚‹å‡¦ç†
- ãƒ†ã‚¹ãƒˆã§ã¯å®Ÿéš›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãŒå‹•ä½œã—ãªã„
- `user.get('user_id')` ã§ user ãŒ None ã®å ´åˆã‚¨ãƒ©ãƒ¼ã®å¯èƒ½æ€§

### å•é¡Œ 2: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã®ä¾å­˜é–¢ä¿‚

ãƒ†ã‚¹ãƒˆã®ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†ã§è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ä¾å­˜æ€§æ³¨å…¥ãŒå¿…è¦

## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ API (/metadata/\*) ã®å•é¡Œ

### å•é¡Œ 1: ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ¬ å¦‚

**ç™ºè¦‹ç®‡æ‰€**: `/metadata/schemas`, `/metadata/schemas/{schema}/tables/{table}/columns`

**ç¾åœ¨ã® API å®Ÿè£…**:

```python
@router.get("/metadata/schemas", response_model=List[Dict[str, Any]])
async def get_schemas_endpoint(metadata_service: MetadataServiceDep):
    """ã‚¹ã‚­ãƒ¼ãƒä¸€è¦§ã‚’å–å¾—ã™ã‚‹"""
    return await run_in_threadpool(metadata_service.get_schemas)

@router.get("/metadata/schemas/{schema_name}/tables/{table_name}/columns", response_model=List[Dict[str, Any]])
async def get_columns_endpoint(schema_name: str, table_name: str, metadata_service: MetadataServiceDep):
    """ã‚«ãƒ©ãƒ ä¸€è¦§ã‚’å–å¾—ã™ã‚‹"""
    return await run_in_threadpool(metadata_service.get_columns, schema_name, table_name)
```

**å•é¡Œ**:

- ã‚µãƒ¼ãƒ“ã‚¹å±¤ã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸå ´åˆã€é©åˆ‡ã«ã‚­ãƒ£ãƒƒãƒã•ã‚Œã¦ã„ãªã„
- ä¾‹å¤–ãŒãã®ã¾ã¾ä¸Šä½ã«ä¼æ’­ã—ã€500 Internal Server Error ã«ãªã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé©åˆ‡ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¦ã„ãªã„
- ãƒ‡ãƒãƒƒã‚°ãŒå›°é›£

**ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é•å**:

```python
# æ¨å¥¨ã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¾‹
@router.get("/metadata/schemas")
async def get_schemas_endpoint(metadata_service: MetadataServiceDep):
    try:
        return await run_in_threadpool(metadata_service.get_schemas)
    except MetadataError as e:
        raise HTTPException(status_code=400, detail=str(e))
    except Exception as e:
        logger.error(f"äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")
        raise HTTPException(status_code=500, detail="ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ")
```

**å½±éŸ¿**:

- æœ¬ç•ªç’°å¢ƒã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§
- ãƒ­ã‚°ãŒé©åˆ‡ã«è¨˜éŒ²ã•ã‚Œãªã„
- ã‚¨ãƒ©ãƒ¼ã®åŸå› ç‰¹å®šãŒå›°é›£

### å•é¡Œ 2: ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®éä¸€è²«æ€§

**ç¾çŠ¶**: FastAPI ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«ä¾å­˜
**å•é¡Œ**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„

### å•é¡Œ 3: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ©Ÿèƒ½é‡è¤‡

**ç™ºè¦‹ç®‡æ‰€**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é–¢é€£ã® 4 ã¤ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**é‡è¤‡å•é¡Œã®è©³ç´°**:

#### **é‡è¤‡ãƒšã‚¢ â‘ â‘¡: åŸºæœ¬ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—**

- `GET /metadata/all` - ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¸ˆã¿ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—
- `GET /metadata/raw` - ç”Ÿãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—

**å®Ÿè£…ä¸Šã®å•é¡Œ**:

```python
# ä¸¡æ–¹ã¨ã‚‚åŒä¸€ã®ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—
all_metadata = await run_in_threadpool(metadata_service.get_all_metadata)
```

**å·®ç•°**:

- `/metadata/all`: `visibility_service.filter_metadata()` ã«ã‚ˆã‚‹æ¨©é™ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚ã‚Š
- `/metadata/raw`: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã—ï¼ˆç”Ÿãƒ‡ãƒ¼ã‚¿ï¼‰

**å•é¡Œç‚¹**:

- æ©Ÿèƒ½çš„é‡è¤‡ã«ã‚ˆã‚‹ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è² è·å¢—å¤§
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå‘½åã®ä¸€è²«æ€§ä¸è¶³
- æ¨©é™ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†æ•£

#### **é‡è¤‡ãƒšã‚¢ â‘¢â‘£: ç®¡ç†è€…æ©Ÿèƒ½**

- `POST /metadata/refresh` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å¼·åˆ¶æ›´æ–°
- `GET /admin/metadata/all-raw` - ç®¡ç†è€…ç”¨ç”Ÿãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—

**å®Ÿè£…ä¸Šã®å•é¡Œ**:

```python
# /metadata/refresh: æ›´æ–° + ãƒ‡ãƒ¼ã‚¿è¿”å´
await run_in_threadpool(metadata_service.refresh_full_metadata_cache)
all_metadata = await run_in_threadpool(metadata_service.get_all_metadata)

# /admin/metadata/all-raw: ãƒ‡ãƒ¼ã‚¿å–å¾—ã®ã¿
all_metadata = await run_in_threadpool(metadata_service.get_all_metadata)
```

**å·®ç•°**:

- `/metadata/refresh`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å¼·åˆ¶æ›´æ–° + çµæœè¿”å´
- `/admin/metadata/all-raw`: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ã®ç®¡ç†è€…ç”¨ãƒ‡ãƒ¼ã‚¿å–å¾—

**å•é¡Œç‚¹**:

- ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯æ–¹å¼ã®ä¸çµ±ä¸€
- æ›´æ–°å‡¦ç†ã¨å–å¾—å‡¦ç†ã®è²¬å‹™æ··åœ¨
- API ãƒ‘ã‚¹ã®å‘½åè¦å‰‡ä¸ä¸€è‡´

### æ¨å¥¨è§£æ±ºç­–

#### **çŸ­æœŸå¯¾å¿œï¼ˆPhase 1ï¼‰**

1. **æ©Ÿèƒ½çµ±åˆã«ã‚ˆã‚‹é‡è¤‡æ’é™¤**:

   - `GET /metadata/raw` â†’ `GET /metadata/all` ã¸ã®çµ±åˆ
   - `GET /admin/metadata/all-raw` â†’ `POST /metadata/refresh` ã¸ã®çµ±åˆ

2. **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ©ç”¨æ–¹é‡ã®æ˜ç¢ºåŒ–**:

   ```
   æ¨å¥¨åˆ©ç”¨:
   - GET /metadata/all: ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ï¼ˆæ¨©é™ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¸ˆã¿ï¼‰
   - POST /metadata/refresh: ç®¡ç†è€…ã«ã‚ˆã‚‹å¼·åˆ¶æ›´æ–°ï¼ˆæ›´æ–°å¾Œãƒ‡ãƒ¼ã‚¿ã‚‚è¿”å´ï¼‰

   å»ƒæ­¢å€™è£œ:
   - GET /metadata/raw: æ©Ÿèƒ½é‡è¤‡ã«ã‚ˆã‚Šå»ƒæ­¢
   - GET /admin/metadata/all-raw: æ©Ÿèƒ½é‡è¤‡ã«ã‚ˆã‚Šå»ƒæ­¢
   ```

#### **é•·æœŸå¯¾å¿œï¼ˆPhase 2ï¼‰**

1. **RESTful API è¨­è¨ˆã®é©ç”¨**:

```
GET /admin/metadata     # ç®¡ç†è€…ç”¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å‚ç…§
POST /admin/metadata/refresh  # ç®¡ç†è€…ã«ã‚ˆã‚‹å¼·åˆ¶æ›´æ–°
```

2. **æ¨©é™ç®¡ç†ã®çµ±ä¸€**:
   - å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ä¸€è²«ã—ãŸæ¨©é™ãƒã‚§ãƒƒã‚¯æ–¹å¼æ¡ç”¨
   - ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒ¬ãƒ™ãƒ«ã§ã®æ¨©é™åˆ¶å¾¡å®Ÿè£…

**å„ªå…ˆåº¦**: ğŸ“‹ ä¸­å„ªå…ˆåº¦ï¼ˆé–‹ç™ºåŠ¹ç‡å½±éŸ¿ï¼‰
**å½±éŸ¿ç¯„å›²**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ API å‘¼ã³å‡ºã—éƒ¨åˆ†ã€ç®¡ç†è€…æ©Ÿèƒ½
**æ¨å®šå·¥æ•°**: 1-2 é€±é–“

### å®Ÿæ–½ï¼ˆ2025-08-13ï¼‰: Phase 1 ã®éç ´å£Šå°å…¥ï¼ˆDeprecation é€šçŸ¥ï¼‰

- ä¸‹è¨˜ã®é‡è¤‡ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å»ƒæ­¢äºˆå‘Šãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä»˜ä¸ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¾Œç¶™ API ã‚’æç¤º:
  - GET `/api/v1/metadata/raw` â†’ ãƒ˜ãƒƒãƒ€ãƒ¼: `Deprecation: true`, `Sunset: +90days`, `Link: </api/v1/metadata/all>; rel=successor-version`
  - GET `/api/v1/admin/metadata/all-raw` â†’ ãƒ˜ãƒƒãƒ€ãƒ¼: `Deprecation: true`, `Sunset: +90days`, `Link: </api/v1/metadata/refresh>; rel=successor-version`
- å®Ÿè£…: `app/api/routes.py`
- å½±éŸ¿: æŒ™å‹•ã¯å¾“æ¥é€šã‚Šï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹æœ¬æ–‡ä¸å¤‰ï¼‰ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§æ®µéšçš„ç§»è¡ŒãŒå¯èƒ½ã€‚

### è¿½åŠ å¯¾å¿œï¼ˆ2025-08-13ï¼‰: èªè¨¼ç³»ãƒ¬ã‚¹ãƒãƒ³ã‚¹çµ±ä¸€ã®æœ€çµ‚æ±ºã‚ã¨/admin/loginã®äº’æ›

- æ–¹é‡æœ€çµ‚æ±ºå®š: èªè¨¼ç³»ã®æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ `{ success: boolean, message: string, user?: object }` ã«çµ±ä¸€
  - `/api/v1/login`: `{ success: true, message: "ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ", user }`
  - `/api/v1/logout`: `{ success: true, message: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ" }`
  - `/api/v1/admin/login`: `{ success: true, message: "ç®¡ç†è€…èªè¨¼æˆåŠŸ" }`
  - `/api/v1/admin/logout`: `{ success: true, message: "ç®¡ç†è€…ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ" }`
- ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¸æ•´åˆã¸ã®å¯¾å¿œ:
  - `AdminLoginRequest` ã« `user_id: Optional[str]` ã‚’è¿½åŠ ã—å¾Œæ–¹äº’æ›ã‚’ç¢ºä¿ï¼ˆç¾æ™‚ç‚¹ã§ã¯æœªä½¿ç”¨ï¼‰ã€‚å¿…é ˆé …ç›®ã¯ `password` ã®ã¿ã€‚
  - å®Ÿè£…: `app/api/models.py`, `app/api/routes.py`
  - äº’æ›å½±éŸ¿: æ—¢å­˜ãƒ†ã‚¹ãƒˆã¯`password`ã®ã¿é€ä¿¡ã§ 200ã€æœªé€ä¿¡ã¯ 422 ã®ã¾ã¾ã€‚
