# gemini 協議事項

## 現在の状況

- SQLdojo アプリにアプリ説明機能が実装済み
- 説明ウィンドウは現在、メインコンテンツの下部に固定表示
- 本体画面と説明ウィンドウが同じスクロール領域を共有している
- 実行結果の説明ステップでエディタは正常に最小化されるが、ダミーの実行結果が表示されない。
- エディタを手動で最大化 → 最小化するとダミーの実行結果が表示される。
- showCurrentStep()でエディタ最小化と同時に insertDummyResults()を呼んでも、最小化直後は results-container の高さが変化しており、描画タイミングの問題で innerHTML が反映されない可能性が高い。

## 改善要求

- 説明ウィンドウを本体画面と完全に分離
- 本体画面と説明ウィンドウを別々に上下スクロール可能にする
- 実行結果の説明表示タイミングで、確実にダミーの実行結果が出力されてほしい。

## ユーザーに確認すべき不足情報

- 説明ウィンドウの推奨サイズ（幅は画面、高さ現状程度）
- 説明ウィンドウの配置位置（中央右下、一意地）
- 説明ウィンドウの最小化・最大化機能の要否
- 説明ウィンドウのドラッグ移動機能のは不要
- なし（現象は再現性が高い）

## 検討すべき改善点

1. フローティングウィンドウ方式への変更
2. 固定位置配置 vs ドラッグ可能配置
3. レスポンシブ対応の調整
4. 既存の説明機能との互換性維持
5. setTimeout による遅延挿入は根本解決になっていない。
6. レイアウト変更やエディタ最小化の DOM 更新が完了した「後」にダミー結果を挿入する必要がある。
7. MutationObserver や requestAnimationFrame など、DOM の描画完了を検知してから insertDummyResults()を呼ぶ方法を検討すべき。

## 実装方針の検討

1. **レイアウト変更**: 説明ウィンドウを独立した div 要素として実装
2. **CSS 調整**: position: fixed を使用して画面右下に固定
3. **スクロール分離**: 本体画面と説明ウィンドウのスクロール領域を完全に分離
4. **サイズ調整**: 適切な幅・高さを設定し、レスポンシブ対応
5. **showCurrentStep()でエディタ最小化後、results-container のサイズ変化を監視し、変化が落ち着いたタイミングで insertDummyResults()を呼ぶ。**
6. **もしくは requestAnimationFrame で複数フレーム後に挿入する。**

## 依頼事項

実行結果の説明表示時にエディタが最小化しますが、ダミーの実行結果が出力されません。その状態でエディタを最大化した後最小化するとダミーの実行結果が表示されます。実行結果の説明表示タイミングでダミーの実行結果が出力されていてほしいです。どこを直せばいいのか教えてください
