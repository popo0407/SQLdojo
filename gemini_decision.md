## Cursor が考える改善方針と理由

### 実装方針

1. **Monaco Editor 選択色の改善**

   - 背景色: 淡い青色 (#E3F2FD)
   - ボーダー色: 濃い青色 (#2196F3)
   - 理由: 視認性が高く、SQL エディタに適した色合い

2. **選択範囲実行機能の実装**

   - Monaco Editor の`getSelection()`API を使用して選択範囲を取得
   - 選択範囲が空の場合は全 SQL 文を実行
   - 選択範囲がある場合はその範囲のみを実行

3. **パラメータ処理の統合方針**

   - 選択範囲内のパラメータのみを処理
   - 選択範囲外のパラメータは無視
   - パラメータが存在しない場合はそのまま実行

4. **エラーハンドリング**
   - 選択範囲が不正な場合のエラー処理
   - パラメータ処理エラーの適切な表示

### 実装理由

- **ユーザビリティ向上**: 選択色の改善により視認性が向上
- **機能拡張**: 部分実行により効率的な SQL 開発が可能
- **開発憲章準拠**: 本番機能の保護、段階的実装、影響範囲の管理

## 依頼事項

Cursor が考える改善方針への意見をお聞かせください。特に以下の点について：

1. 選択色の色指定の妥当性
2. 選択範囲実行の実装方針
3. パラメータ処理の統合方針
4. エラーハンドリングの詳細

## パーツ機能実装の方針決定

### 実装方針

1. **データベース設計**: 既存テンプレートテーブルと同様の構造でパーツテーブルを作成
2. **API 設計**: テンプレート API と同様の CRUD 操作をパーツ用に実装
3. **フロントエンド**: テンプレート管理画面と統一感のあるパーツ管理画面を実装
4. **挿入ロジック**: エディタサービスでテンプレート（置換）とパーツ（追加）の挿入方式を分岐

### 実装理由

- **既存機能との統一性**: テンプレート機能の設計パターンを踏襲することで開発効率と保守性を向上
- **段階的実装**: データベース →API→ フロントエンドの順でリスクを最小化
- **ユーザビリティ**: 既存 UI との統一感により学習コストを低減

### 技術的考慮事項

- パーツテーブルはテンプレートテーブルと同様の構造（id, name, content, user_id, is_common 等）
- エディタ挿入時は、テンプレートは replaceContent、パーツは insertText で分岐
- UI は既存のテンプレート管理画面をベースにパーツ用タブを追加

この方針で実装を進めます。
