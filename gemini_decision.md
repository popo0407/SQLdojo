# ログ保存方法の複数化に関する方針決定

## 改善方針

ストラテジーパターンと依存性注入を活用した段階的実装を採用する。

### 実装手順

1. **BaseLogHandler 抽象クラスの作成**

   - すべてのログハンドラが従う共通インターフェースを定義
   - 単一責任の原則に従い、ログ保存のみに特化

2. **各ログ保存方法の独立実装**

   - OracleLogHandler: 既存ロジックの移動
   - SqliteLogHandler: 新規実装
   - SnowflakeLogHandler: 新規実装
   - 各ファイルを独立して管理し、関心の分離を徹底

3. **ファクトリー関数による動的切り替え**

   - 設定ファイルからログ保存タイプを読み取り
   - 適切なハンドラを自動選択
   - 依存性注入による疎結合化

4. **既存 SQLLogService の修正**
   - 具体的な処理を委任するだけのシンプルな役割に変更
   - 注入されたハンドラに処理を委任

## 開発憲章準拠の理由

- **単一責任の原則**: 各ハンドラは特定のログ保存方法のみを担当
- **関心の分離**: ログ保存ロジックとビジネスロジックを明確に分離
- **依存性注入**: 具体的な実装ではなく抽象に依存
- **設定とロジックの分離**: .env ファイルでログ保存方法を制御
- **段階的実装**: 既存機能を保護しながら段階的に移行
- **テスト容易性**: 各ハンドラを独立してテスト可能

## リスク管理

- 既存の Oracle ログ機能を完全に保護
- 各段階での動作確認を徹底
- 影響範囲の事前分析と管理
